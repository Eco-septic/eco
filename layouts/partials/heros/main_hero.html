<section
  aria-label="Hero section"
  class="relative flex h-[calc(100vh_-_3.5rem)] lg:h-[calc(100vh_-_5rem)] overflow-hidden text-white"
>
  <!-- Hero Text -->
  <div class="z-10 container flex flex-col items-start space-y-4 m-auto">
    <div id="textAnimation" class="text-2xl font-bold overflow-visible">
      {{ .Params.hero.textAnimation }}
    </div>
    <h1 class="text-2xl">
      {{ .Params.title }}
    </h1>
    <ul class="list-disc pl-4">
      {{ range .Params.hero.pitchList }}
        <li>{{ . }}</li>
      {{ end }}
    </ul>
    {{ with site.Menus.mainmenu }}
      {{ range where . "PageRef" "/products" }}
        <a href="{{ .URL }}" class="block">
          <button class="rounded-3xl py-2 px-4 bg-lime-600">{{ .Name }}</button>
        </a>
      {{ end }}
    {{ end }}
  </div>

  <!-- Image Slider Container -->
  <div id="slider" aria-label="image slider" class="absolute inset-0">
    <!-- Slider Images -->
    {{ range $index, $image := .Params.hero.images }}
      <img
        class="size-full object-cover brightness-50 absolute top-0 left-0 bottom-0 right-0 transition-opacity duration-700 ease-in-out"
        src="{{ $image }}"
        alt="Slide {{ $index }}"
      />
    {{ end }}
  </div>

  <!-- Navigation Buttons -->
  <button
    id="prevBtn"
    class="absolute left-5 top-1/2 transform -translate-y-1/2 text-white p-2 rounded-full z-20"
  >
    &larr;
  </button>
  <button
    id="nextBtn"
    class="absolute right-5 top-1/2 transform -translate-y-1/2 text-white p-2 rounded-full z-20"
  >
    &rarr;
  </button>

  <!-- Pagination Dots -->
  <div
    class="absolute bottom-4 left-1/2 transform -translate-x-1/2 flex gap-2 z-10"
  >
    {{ range $index, $image := .Params.hero.images }}
      <span
        class="dot w-3 h-3 bg-gray-300 rounded-full cursor-pointer"
        data-index="{{ $index }}"
      ></span>
    {{ end }}
  </div>
</section>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const textContainer = document.getElementById("textAnimation");
    const text = textContainer.textContent.trim(); // Get the original text
    textContainer.textContent = ""; // Clear the container

    // Create a wrapper div to contain all character divs
    const wrapperDiv = document.createElement("div");
    wrapperDiv.className = "heroWrapperDiv"; // Tailwind classes for centering and layout
    textContainer.appendChild(wrapperDiv);

    // Split text into individual characters and wrap in divs
    text.split("").forEach((char, index) => {
      const charDiv = document.createElement("div");
      charDiv.className = "heroCharDic";
      charDiv.textContent = char === " " ? "\u00A0" : char; // Replace space with non-breaking space for correct spacing

      // Append each character div to the wrapper div
      wrapperDiv.appendChild(charDiv);

      // Animate the character div from top to its final position
      setTimeout(() => {
        charDiv.classList.remove("heroCharDic"); // Remove initial classes for animation
        charDiv.classList.add("heroCharDicAnimation"); // Add final classes for animation
      }, index * 100); // 0.1s delay for each character
    });

    const slider = document.getElementById("slider");
    const dots = document.querySelectorAll(".dot");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");

    let currentIndex = 0;
    const totalSlides = slider.children.length;

    // Helper function to update slider position with opacity transitions
    const updateSliderPosition = () => {
      Array.from(slider.children).forEach((img, index) => {
        if (index === currentIndex) {
          img.style.opacity = "1"; // Show the active image
          img.style.zIndex = "1"; // Make sure the current image is on top
        } else {
          img.style.opacity = "0"; // Hide other images
          img.style.zIndex = "0"; // Push non-active images back
        }
      });

      // Update dots to reflect the current slide
      dots.forEach((dot, index) => {
        dot.style.backgroundColor = index === currentIndex ? "gray" : "#E5E7EB"; // Change dot color for active slide
      });
    };

    // Next Button Event Listener
    nextBtn.addEventListener("click", () => {
      currentIndex = (currentIndex + 1) % totalSlides;
      updateSliderPosition();
    });

    // Previous Button Event Listener
    prevBtn.addEventListener("click", () => {
      currentIndex = (currentIndex - 1 + totalSlides) % totalSlides;
      updateSliderPosition();
    });

    // Pagination Dots Event Listener
    dots.forEach((dot) => {
      dot.addEventListener("click", () => {
        currentIndex = parseInt(dot.getAttribute("data-index"));
        updateSliderPosition();
      });
    });

    // Initial Slider Position
    updateSliderPosition();
  });
</script>
